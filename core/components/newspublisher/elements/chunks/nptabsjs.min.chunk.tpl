<script type="text/javascript">$(document).ready(function(){var activeButton='[[+activeButton]]'.toLowerCase();var buttonsJsonStr=JSON.stringify([[+buttonsJson]]);var buttonsJson=(buttonsJsonStr)?$.parseJSON(buttonsJsonStr):null;if((buttonsJson!=null)&&(typeof buttonsJson=='object')){var htmlButtons='';var filterId='filters';var buttonPrefixClass='btn-';var filterSelected='filterSelected';var filterItemClass='filter-item';var npHiddenClass='np-hidden';var excludeItems=$('.buttons, [name="np_existing"], [name="np_doc_id"], #hidSubmit');var form=$('form#newspublisherForm');var insertAfterElement=$('h2#newspublisherHeader').eq(0);var jsonFieldsCount=0;var hasFilterSelected=false;$.each(buttonsJson,function(buttonName,aFields){var buttonClass=buttonPrefixClass+buttonName;var aClass='';if(activeButton==buttonName.toLowerCase()){aClass=filterSelected;hasFilterSelected=true}htmlButtons+='<li id="np-buttons"><a class="'+aClass+'" data-filter=".'+buttonClass+'" href="#">'+buttonName+'</a></li>';$.each(aFields,function(index,fieldName){var field=$('[name^="'+fieldName+'"]:last');if(field.length>0){var parent=field;while(parent.parent().get(0).nodeName.toLowerCase()!='form'){parent=parent.parent()}jsonFieldsCount++;parent.addClass(filterItemClass);parent.addClass(buttonClass)}else{alert('[[%np_could_not_find_tab_field]]'+fieldName)}})});htmlButtons='<section id="np-tabs" class="clearfix">'+'<ul id="'+filterId+'">'+htmlButtons+'<li id="other-filter"><a data-filter="!*" href="#">[[%np_tabs_other]]</a></li>'+'<li class="data-filter"><a data-filter="*" href="#" class="'+(hasFilterSelected?'':filterSelected)+'">[[%np_tabs_show_all]]</a></li>'+'</ul>'+'</section>';$(htmlButtons).insertAfter(insertAfterElement);var filterItems=form.find('.'+filterItemClass);var formChildren=form.children().not(excludeItems);var filters_a=$('#'+filterId+' a');filters_a.click(function(){var selector=$(this).data('filter');console.log(selector);if(selector=='*'){formChildren.removeClass('np-hidden')}else if(selector=='!*'){formChildren.addClass(npHiddenClass);formChildren.not('.'+filterItemClass).removeClass(npHiddenClass)}else{formChildren.addClass(npHiddenClass);formChildren.filter(selector).removeClass(npHiddenClass)}$('#'+filterId+' a.'+filterSelected).removeClass(filterSelected);$(this).addClass(filterSelected);return false});if(formChildren.length==jsonFieldsCount){$('#other-filter').addClass('np-hidden')}if(hasFilterSelected){filters_a.filter('.'+filterSelected).eq(0).trigger('click')}}else{alert('[[%np_invalid_tabs]]')}});</script>
